<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.maeumi.prj.order.service.orderMapper">
		<insert id="orderInsert" parameterType="co.maeumi.prj.order.service.order_datailVO">
				INSERT INTO ORDER_DETAIL(
					OR_NO,
					OR_UID,
					PR_NO,
					GR_NO,
					OR_DATE,
					OR_TYPE,
					OR_PRICE,
					M_NICKNAME,
					M_EMAIL,
					OR_STATUS,
					c_email
				)
				VALUES(
					(SELECT NVL(MAX(OR_NO),0)+1 FROM ORDER_DETAIL O),
					#{or_uid},
					0,
					#{gr_no},
					sysdate,
					'0',
					#{or_price},
					'닉네임 세션값이 들어감',
					'이메일 세션값이 들어감',
					'0',
					#{c_email}						
				)
		</insert>
		
		<select id="selectorderList" parameterType="co.maeumi.prj.order.service.order_datailVO" resultType="co.maeumi.prj.order.service.order_datailVO">
		  			SELECT O.OR_UID, C.GR_DATE, C.GR_TYPE, O.OR_DATE, O.OR_PRICE
		  			FROM ORDER_DETAIL O JOIN GROUP_RESERVE C
					ON (O.GR_NO = C.GR_NO)
		  			WHERE OR_NO = #{or_no}
		</select>
		
		<insert id="orderPersonalInsert">
					insert into order_detail(
                       or_no,
                       or_uid,
                       pr_no,
                       gr_no,
                       or_date,
                       or_type,
                       or_price,
                       m_nickname,
                       m_email,
                       or_status
                )
                values(
                      (SELECT NVL(MAX(or_no),0)+1 FROM order_detail N),
                      #{or_uid},
                      #{pr_no},
                      0,
                      sysdate,
                      '아직안옴',
                      #{or_price},
                      '세션값 이름 입니다.',
                      '세션값 이메일 입니다',
                      '0'
                )
		</insert>
		
		<select id="MaxGroupOrder" resultType="int">
		 		SELECT MAX(OR_NO) 
		 		FROM ORDER_DETAIL
		</select>
</mapper>